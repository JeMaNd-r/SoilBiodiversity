"section","subsection","element","Value"
"Overview","Authorship","Study title","European distribution of common earthworm species"
"Overview","Authorship","Author names","Romy Zeiss; Carlos Antonio Guerra; Laura-Fiona Hepner; Jessica Dahlke; Jérome Mathieu; Ângela Lomba"
"Overview","Authorship","Contact ","romy.zeiss@idiv.de"
"Overview","Authorship","Study link",""
"Overview","Model objective","Model objective","Mapping and interpolation"
"Overview","Model objective","Target output","Maps of relative probability of presence, and of overall species richness (probability >60%)"
"Overview","Focal Taxon","Focal Taxon","Earthworms (Clitellata: Crassiclitellata)"
"Overview","Location","Location","Europe"
"Overview","Scale of Analysis","Spatial extent","32, 75, -7, 53 (xmin, xmax, ymin, ymax)"
"Overview","Scale of Analysis","Spatial resolution","1"
"Overview","Scale of Analysis","Temporal extent","2015 (datasets from different time periods between 2001-2021) and 2050 (future climate 2041-2070)"
"Overview","Scale of Analysis","Temporal resolution","1 year"
"Overview","Scale of Analysis","Boundary","political"
"Overview","Biodiversity data","Observation type","citizen science; field survey; standardised monitoring data"
"Overview","Biodiversity data","Response data type","point occurrence; presence-only"
"Overview","Predictors","Predictor types","climatic; edaphic; habitat; topographic"
"Overview","Hypotheses","Hypotheses","Earthworms are shown to be driven by climatic, topographic, habitat and edaphic factors (Mueller et al. 2016, Phillips et al. 2019). The main drivers of earthworm distribution are (1) soil moisture, which is related to the availability of water through precipitation and can also be expressed as aridity (proportion of precipitation to evapotranspiration), (2) chemical and physical soil properties, such as pH, cation and heavy metal concentrations as well as soil texture, but also (3) the amount of organic carbon in soil that serves as resource for earthworms. In addition, (4) topographic factors were shown to drive large-scale distribution of many organisms including earthworms (Phillips et al. 2019).

We included the following variables to represent climatic factors: Aridity Index, Mean annual precipitation (MAP), and Precipitation seasonality (MAP_seas), Mean annual temperature (MAT), Temperature seasonality (MAT_seas), mean of the yearly Nitrogen deposition (Nit_Depo), and Snow cover (i.e., number of days with snow cover). 
As habitat factors, we decided on the proportion of area covered by different land-use types, namely Agriculture, Forest, Pastures, and Shrubland. In addition, we included Distance to urban areas, Land fragmentation, and Population Density in our models. To account for topographic factors, we included Elevation, Aspect (i.e., direction of a slope), Slope, Latitude, as well as Distance to coast, and Distance to rivers. Finally, edaphic factors are depicted by Cation exchange capacity (CEC), soil texture expressed as Clay+Silt content, concentration of Copper (Cu), Mercury (Hg), Nitrogen (N), and Phosphorus (P), as well as pH in H20, and content of Soil organic carbon (SOC)."
"Overview","Assumptions","Model assumptions","Species-environment (pseudo-) equilibrium, No observation bias issues, Independence of species observations, Availability of all important predictors, Predictors are free of error, Niche stability/constancy & niche conservatism, No other extrapolation issues"
"Overview","Algorithms","Modelling techniques","maxent; biomod; ensemble"
"Overview","Algorithms","Model complexity",""
"Overview","Algorithms","Model averaging","For species with at least 100 records, we performed BIOMOD ensemble modelling using all 10 available algorithms to estimate average probability of presence (ROC as evaluation criteria). For species present in 10-99 grid cells, we used the Ensemble of Small Models (ESM) approach (Breiner et al. 2015, Methods in Ecol & Evol)."
"Overview","Workflow","Model workflow","Prior to model building, we standardized all predictor variables and used variance inflation (VIF) analysis to avoid highly correlated variables. We only included the top ten most important (MaxEnt pre-analysis) and weakly correlated (Pearson correlation) variables. 
Model fitting was done automatically as much as possible. In addition, we generated individual background data for the models to increase their performances. Predictive model performance was assessed using TSS, AUC(PRG) and AUC(ROC), and Kappa."
"Overview","Software","Software","R version 4.2.0 (R Core Team 2016). RStudio version 2022.02.3 (RStudio Team 2020). ArcGIS version 10.7.1 (Bajjali 2018)."
"Overview","Software","Code availability","The code is available at GitHub (XXX)."
"Overview","Software","Data availability","The input data are available at XXX."
"Data","Biodiversity data","Taxon names","We included European earthworm species (Clitellata: Crassiclitellata) that were present in at least 10 grid cells (cell size: 2x2km). The respective 52 species' names can be found in the Appendix."
"Data","Biodiversity data","Taxonomic reference system","GBIF: mainly  World List of Marine Oligochaeta (2021); Edaphobase: no further information; Phillips et al. 2019: DriloBASE and experts' classification; Mathieu et al. 2022: XXX"
"Data","Biodiversity data","Ecological level","species"
"Data","Biodiversity data","Data sources","Freely available data at GBIF (https://www.gbif.org/, DOI and accession date for each species can be found in the Supplementary to this paper) and EDAPHOBASE (https://portal.edaphobase.org/); dataset collected by Phillips et al. 2019 and dataset compiled by Jérome Mathieu."
"Data","Biodiversity data","Sampling design","opportunistic, volunteer-based recording schemes"
"Data","Biodiversity data","Sample size","Minimum sample size: present in 10 grid cells, that is 12 or more occurrence records per species."
"Data","Biodiversity data","Clipping","We clipped all data to the political boundary of Europe including 13 additional countries (Albania, Belarus, Bosnia-Herzegovina, Great Britain, Iceland, Kosovo, Mazedonia, Moldawia, Montenegro, Norway, Serbia, Switzerland, and Ukraine)."
"Data","Biodiversity data","Scaling","Spatial thinning: We defined presence/absence in each 2 x 2km grid cell across Europe based on the respective occurrence records per species using ArcGIS (Zonal Statistics) and R (raster::resample())."
"Data","Biodiversity data","Cleaning","Data filtering: Earthworm species that had less than 10 occurrence records were excluded from the modelling. We excluded records before 1970 and checked for spatial bias in occurrence coordinates using the R package CoordinateCleaner."
"Data","Biodiversity data","Absence data","No true absence data were used."
"Data","Biodiversity data","Background data","We generated random background points within the study area using the R package biomod2. We followed advice from Barbet-Massin et al. 2012 to calculate model-specific background data that were shown to increase predictive performance. If no model-specific advice was given, we used the 10,000 randomly sampled background points also used for GLM and GAM."
"Data","Biodiversity data","Errors and biases","Citizens science data can show bias regarding XXX (REF). Overall, occurrence data have been collected using different sampling effort and methodology leading to potential errors because of detection probability, sampling coverage, and sampling depth (e.g., soil cores of 10cm vs. deeper sampling strategies using extraction solutions). Spatial bias: Certain countries were sampled more in depth than other countries (e.g. Germany or Great Britain vs. Poland), but there have also been differences in sampling intensity within countries (e.g., low intensity in Italy vs. high in France vs. clustered sampling in Spain). Temporal bias: Occurrences were recorded between 1970 and 2022 (mean: 2004, median: 2007), that may include climate variation and land-use changes. We accounted for temporal changes by weighing more recent records stronger in our models."
"Data","Data partitioning","Training data","We randomly selected 80% of data for model calibration, leaving the remaining 20% for model evaluation in 10-fold cross-validation."
"Data","Data partitioning","Validation data","The models were evaluated using True Skill Statistic (TSS), Area under curve (AUC) for PRG and ROC, and Kappa estimate."
"Data","Data partitioning","Test data","We randomly selected 20% of our data for model evaluation (10-fold cross-validation), and did not validate the predictions with an independent dataset."
"Data","Predictor variables","Predictor variables","We selected 29 predictors based on our understanding of the ecology of the earthworms. Seven climatic variables: aridity index, mean annual precipitation (MAP), and precipitation seasonality (MAP_seas), mean annual temperature (MAT), temperature seasonality (MAT_seas), mean of the yearly nitrogen deposition (Nit_Depo), and snow cover (i.e., number of days with snow cover). Seven habitat factors: four land-use types (agriculture, forest, pastures, and shrubland), distance to urban areas, land fragmentation, and population density in our models. Six topographic variables: elevation, aspect (i.e., direction of a slope), slope, latitude, as well as distance to coast, and distance to rivers. And nine edaphic factors: cation exchange capacity (CEC), soil texture expressed as clay+silt content, concentration of copper (Cu), mercury (Hg), nitrogen (N), and phosphorus (P), as well as pH in H20, content of soil organic carbon (SOC), and soil temperature at 0-5 cm depth (SoilT)."
"Data","Predictor variables","Data sources","Information on the data source for each environmental variable are given in the paper. We downloaded all data from the respective databases listed in the Appendix."
"Data","Predictor variables","Spatial extent","32, 75, -7, 53 (xmin, xmax, ymin, ymax)"
"Data","Predictor variables","Spatial resolution","between 25m (Slope) and 3.5km x 7km (Nitrogen diposition)"
"Data","Predictor variables","Coordinate reference system","WGS 1984, EPSG:4326"
"Data","Predictor variables","Temporal extent","Between 1981 and 2021 (2070 for future climate)"
"Data","Predictor variables","Temporal resolution","Time periods of data collection are ranging from 1 year (1 sampling campaign) to 11 years, and from hourly measures (e.g. CHELSA climate variables) to yearly measures (e.g. CORINE land cover data). For time series, the mean value of the yearly measurements was calculated."
"Data","Predictor variables","Data processing","Environmental layers were downscaled to 2km and 5km using the ArcGIS function Zonal Statistics, or the R function raster::resample()."
"Data","Predictor variables","Errors and biases","Spatial bias: Data gaps in certain countries (e.g. Albania, Bosnia & Herzegovina, Croatia, Italy, Poland, and more). Temporal issues: Environmental data do not reflect sampling conditions due to strong variation in sampling periods and missing detail information at and on sampling times."
"Data","Predictor variables","Dimension reduction","Predictor variables were standardized and we used variance inflation (VIF) analysis to avoid highly correlated variables. We only included the ten most important and weakly correlated variables."
"Data","Transfer data","Data sources","same as Predictor variables"
"Data","Transfer data","Spatial extent",
"Data","Transfer data","Spatial resolution","same as Predictor variables"
"Data","Transfer data","Temporal extent","same as Predictor variables"
"Data","Transfer data","Temporal resolution","same as Predictor variables"
"Data","Transfer data","Models and scenarios","see references of the individual variables"
"Data","Transfer data","Data processing","same as Predictor variables"
"Data","Transfer data","Quantification of Novelty",""
"Model","Variable pre-selection","Variable pre-selection","We selected variables according to the literature (see paper)."
"Model","Multicollinearity","Multicollinearity","We removed variables with Pearson correlation >0.8 and variable inflation factor (VIF) >0.8."
"Model","Model settings","Model settings (fitting)","maxent: notes (R package caret, used to identify the ten most important predictors), removeDuplicates (FALSE), rgs (automatically-tuned parameters (see R script)); biomod: models (GLM, GBM, GAM, CTA, ANN, FDA, MARS, RF, MAXENT.Phillips), model.options (algorithm-specific settings (see R script)), NbRunEval (10), DataSplit (80), models.eval.meth (""TSS""), rescal.all.models (FALSE), do.full.models (FALSE), em.by (""all""), eval.metric (""TSS""), eval.metric.quality.threshold (NULL), prob.mean (FALSE), prob.cv (TRUE), prob.ci (FALSE), prob.median (FALSE), committee.averaging (TRUE), prob.mean.weight (TRUE), prob.mean.weight.decay (""proportional""), VarImport (5); ensemble: models (GLM, GBM and MaxEnt), combinationMethod (average of predictions), notes (Ensemble of Small Models (ESM; Breiner et al. 2015)), weighting.score (""TSS""), tune (TRUE), NbRunEval (10), DataSplit (80), Prevalence (NULL)"
"Model","Model settings","Model settings (extrapolation)",""
"Model","Model estimates","Coefficients","mean posterior"
"Model","Model estimates","Parameter uncertainty",""
"Model","Model estimates","Variable importance","permutation importance for MaxEnt; biomod2::get_variables_importance for BIOMOD and ESM (i.e., Pearson correlation of difference between reference and shuffled prediction)."
"Model","Model selection - model averaging - ensembles","Model selection","We used the R package biomod2 to create an ensemble model with all ten available algorihtms (GLM, GBM, GAM, CTA, ANN, SRE, FDA, MARS, RF and MAXENT.Phillips). For species with 10-99 occurrence records, we performed small ensemble models with 3 algorithms (GLM, GBM, MaxEnt)."
"Model","Model selection - model averaging - ensembles","Model averaging",""
"Model","Model selection - model averaging - ensembles","Model ensembles","see R script"
"Model","Analysis and Correction of non-independence","Spatial autocorrelation",""
"Model","Analysis and Correction of non-independence","Temporal autocorrelation",""
"Model","Analysis and Correction of non-independence","Nested data",""
"Model","Threshold selection","Threshold selection","We used the threshold at maximum TSS value to transform predictions into binary ones."
"Assessment","Performance statistics","Performance on training data","TSS"
"Assessment","Performance statistics","Performance on validation data","TSS"
"Assessment","Performance statistics","Performance on test data","TSS"
"Assessment","Plausibility check","Response shapes",""
"Assessment","Plausibility check","Expert judgement",""
"Prediction","Prediction output","Prediction unit","Continuous predictions of occurrence probability per species and predicted presence per species that were obtained by binarizing the predicted occurrence probabilities using the threshold selection method based on maximizing TSS value."
"Prediction","Prediction output","Post-processing","In the Supplementary to this paper, output maps of occurrence probability and overall species richness are clipped to the German political boundary."
"Prediction","Uncertainty quantification","Algorithmic uncertainty",""
"Prediction","Uncertainty quantification","Input data uncertainty",""
"Prediction","Uncertainty quantification","Parameter uncertainty",""
"Prediction","Uncertainty quantification","Scenario uncertainty",""
"Prediction","Uncertainty quantification","Novel environments",""
