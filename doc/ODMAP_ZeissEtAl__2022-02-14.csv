"section","subsection","element","Value"
"Overview","Authorship","Study title","European distribution of common earthworm species"
"Overview","Authorship","Author names","Romy Zeiss; Carlos Antonio Guerra; Laura-Fiona Hepner; Jessica Dahlke"
"Overview","Authorship","Contact ","romy.zeiss@idiv.de"
"Overview","Authorship","Study link",""
"Overview","Model objective","Model objective","Mapping and interpolation"
"Overview","Model objective","Target output","Maps of relative probability of presence, and of overall species richness (probability >60%)"
"Overview","Focal Taxon","Focal Taxon","Earthworms (Clitellata: Crassiclitellata)"
"Overview","Location","Location","Europe"
"Overview","Scale of Analysis","Spatial extent","32, 75, -7, 53 (xmin, xmax, ymin, ymax)"
"Overview","Scale of Analysis","Spatial resolution","1"
"Overview","Scale of Analysis","Temporal extent","2015 (datasets from different time periods between 2001-2021)"
"Overview","Scale of Analysis","Temporal resolution","1 year"
"Overview","Scale of Analysis","Boundary","political"
"Overview","Biodiversity data","Observation type","citizen science; field survey; standardised monitoring data"
"Overview","Biodiversity data","Response data type","point occurrence; presence-only"
"Overview","Predictors","Predictor types","climatic; edaphic; habitat; topographic"
"Overview","Hypotheses","Hypotheses","Earthworms are shown to be driven by climatic, topographic, habitat and edaphic factors (Mueller et al. 2016, Phillips et al. 2019). The main drivers of earthworm distribution are (1) soil moisture, which is related to the availability of water through precipitation and can also be expressed as aridity (proportion of precipitation to evapotranspiration), (2) chemical and physical soil properties, such as pH, cation and heavy metal concentrations as well as soil texture, but also (3) the amount of organic carbon in soil that serves as resource for earthworms. In addition, (4) topographic factors were shown to drive large-scale distribution of many organisms including earthworms (Phillips et al. 2019).

We included the following variables to represent climatic factors: Aridity Index, Mean annual precipitation (MAP), and Precipitation seasonality (MAP_seas), Mean annual temperature (MAT), Temperature seasonality (MAT_seas), mean of the yearly Nitrogen deposition (Nit_Depo), and Snow cover (i.e., number of days with snow cover). 
As habitat factors, we decided on the proportion of area covered by different land-use types, namely Agriculture, Forest, Pastures, and Shrubland. In addition, we included Distance to urban areas, Land fragmentation, and Population Density in our models. To account for topographic factors, we included Elevation, Aspect (i.e., direction of a slope), Slope, Latitude, as well as Distance to coast, and Distance to rivers. Finally, edaphic factors are depicted by Cation exchange capacity (CEC), soil texture expressed as Clay+Silt content, concentration of Copper (Cu), Mercury (Hg), Nitrogen (N), and Phosphorus (P), as well as pH in H20, and content of Soil organic carbon (SOC)."
"Overview","Assumptions","Model assumptions","Species-environment (pseudo-) equilibrium, No observation bias issues, Independence of species observations, Availability of all important predictors, Predictors are free of error, Niche stability/constancy & niche conservatism, No other extrapolation issues"
"Overview","Algorithms","Modelling techniques","maxent; glm; gam; mars; randomForest; brt; ann; fda; lasso; ridge; biomod; ensemble"
"Overview","Algorithms","Model complexity",""
"Overview","Algorithms","Model averaging","We combined the five most independent models (i.e., gam, lasso, maxent, brt, randomForest) and averaged their predicted species presence probabilities. In addition, we used BIOMOD ensemble modelling to estimate average probability of presence (ROC as evaluation criteria)."
"Overview","Workflow","Model workflow","Prior to model building, we standardized all predictor variables and used variance inflation (VIF) analysis to avoid highly correlated variables. We only included the twenty most important and weakly correlated variables. 
Model fitting was done automatically as much as possible. In addition, we generated individual background data for the models to increase their performances. Predictive model performance was assessed using TSS, AUC(PRG) and AUC(ROC), and Kappa."
"Overview","Software","Software","R version XXX (R Core Team 2016) in RStudio version XXX (RStudio Team 2020) including the following R packages: XXXX. ArcGIS version XXX (Bajjali 2018)."
"Overview","Software","Code availability","The code is available at GitHub (XXX)."
"Overview","Software","Data availability","The input data are available at XXX."
"Data","Biodiversity data","Taxon names","We included European earthworm species (Clitellata: Crassiclitellata) that were present in at least 5 grid cells (cell size: 1x1km). The respective 63 species' names can be found in the Appendix."
"Data","Biodiversity data","Taxonomic reference system","GBIF: mainly  World List of Marine Oligochaeta (2021); Edaphobase: no further information; Phillips et al. 2019: DriloBASE and experts' classification."
"Data","Biodiversity data","Ecological level","species"
"Data","Biodiversity data","Data sources","Freely available data at GBIF (https://www.gbif.org/, DOI and accession date for each species can be found in the Supplementary to this paper), earthworm data on request because only partly included in EDAPHOBASE (https://portal.edaphobase.org/), and dataset collected by Phillips et al. 2019."
"Data","Biodiversity data","Sampling design","opportunistic, volunteer-based recording schemes"
"Data","Biodiversity data","Sample size","Minimum sample size: 5 grid cells, that is 7 or more occurrence records per species."
"Data","Biodiversity data","Clipping","We clipped all data to the political boundary of Europe."
"Data","Biodiversity data","Scaling","We defined presence/absence in each 1 x 1km grid cell across Europe based on the respective occurrence records per species using ArcGIS."
"Data","Biodiversity data","Cleaning","Earthworm species that had less than 200 occurrence records were excluded from the modelling. We checked for bias in occurrence coordinates using the R package CoordinateCleaner."
"Data","Biodiversity data","Absence data","No true absence data were used."
"Data","Biodiversity data","Background data","We generated random background points within the study area using the R package biomod2. We followed advice from Barbet-Massin et al. 2012 to calculate model-specific background data that were shown to increase predictive performance. If no model-specific advice was given, we used the 50,000 randomly sampled background points also used for GLM and GAM."
"Data","Biodiversity data","Errors and biases","Citizens science data can show bias regarding XXX (REF). Overall, occurrence data have been collected using different sampling effort and methodology leading to potential errors because of detection probability, sampling coverage, and sampling depth (e.g., soil cores of 10cm vs. deeper sampling strategies using extraction solutions). Spatial bias: Certain countries were sampled more in depth than other countries (e.g. XX vs. Norway), but there have also been differences in sampling intensity within countries (e.g., low intensity in XX vs. high in XX). Temporal bias: Occurrences were recorded between 19XX and 202X (mean: 20XX), that may include climate variation and land-use changes. We did not account for such temporal changes in our models."
"Data","Data partitioning","Training data","We randomly selected 60% of data for model calibration, leaving the remaining 40% for model evaluation and validation of the predictions."
"Data","Data partitioning","Validation data","The models were evaluated using True Skill Statistic (TSS), Area under curve (AUC) for PRG and ROC, and Kappa estimate."
"Data","Data partitioning","Test data","We randomly selected 20%of our data for model evaluation, and 20% for validation of the predictions."
"Data","Predictor variables","Predictor variables","We selected XX predictors based on our understanding of the ecology of the earthworms. Seven climatic variables: aridity index, mean annual precipitation (MAP), and precipitation seasonality (MAP_seas), mean annual temperature (MAT), temperature seasonality (MAT_seas), mean of the yearly nitrogen deposition (Nit_Depo), and snow cover (i.e., number of days with snow cover). Seven habitat factors: four land-use types (agriculture, forest, pastures, and shrubland), distance to urban areas, land fragmentation, and population density in our models. Six topographic variables: elevation, aspect (i.e., direction of a slope), slope, latitude, as well as distance to coast, and distance to rivers. And eight edaphic factors: cation exchange capacity (CEC), soil texture expressed as clay+silt content, concentration of copper (Cu), mercury (Hg), nitrogen (N), and phosphorus (P), as well as pH in H20, and content of soil organic carbon (SOC)."
"Data","Predictor variables","Data sources","Information on the data source for each environmental variable are given in the paper. We downloaded all data from the respective databases listed in the Appendix."
"Data","Predictor variables","Spatial extent","32, 75, -7, 53 (xmin, xmax, ymin, ymax)"
"Data","Predictor variables","Spatial resolution","between 25m (Slope) and 3.5km x 7km (Nitrogen diposition)"
"Data","Predictor variables","Coordinate reference system","WGS 1984, EPSG:4326"
"Data","Predictor variables","Temporal extent","Between 1981 and 2021"
"Data","Predictor variables","Temporal resolution","Time periods of data collection are ranging from 1 year (1 sampling campaign) to 11 years, and from hourly measures (e.g. XX) to yearly measures (e.g. XX). For time series, the mean value of the yearly measurements was calculated."
"Data","Predictor variables","Data processing","Environmental layers were downscaled to 1km using XXX."
"Data","Predictor variables","Errors and biases","Spatial bias: Data gaps in certain countries (e.g. XXX). Temporal issues: Environmental data do not reflect sampling conditions due to strong variation in sampling periods."
"Data","Predictor variables","Dimension reduction","Predictor variables were standardized and used variance inflation (VIF) analysis to avoid highly correlated variables. We only included the twenty most important and weakly correlated variables."
"Data","Transfer data","Data sources","same as Predictor variables"
"Data","Transfer data","Spatial extent",
"Data","Transfer data","Spatial resolution","same as Predictor variables"
"Data","Transfer data","Temporal extent","same as Predictor variables"
"Data","Transfer data","Temporal resolution","same as Predictor variables"
"Data","Transfer data","Models and scenarios","see references of the individual variables"
"Data","Transfer data","Data processing","same as Predictor variables"
"Data","Transfer data","Quantification of Novelty",""
"Model","Variable pre-selection","Variable pre-selection","We selected variables according to the literature (see paper)."
"Model","Multicollinearity","Multicollinearity","We removed variables with XXX"
"Model","Model settings","Model settings (fitting)","maxent: notes (R package caret), removeDuplicates (FALSE), rgs (automatically-tuned parameters (see R script)); glm: family (binomial (link = ""logit"")), formula (occurrence  ~ .), weights (true presence records: weight = 1, pseudo-absence records: weight = presenceNum / backgroundNum), notes (In addition, we run gam::step.GAM() with automatically-defined model scope (i.e., estimated relationships of predictors based on gam::gam.scope()), and glmnet::cv.glmnet() with alpha = 1 for lasso and alpha = 0 for ridge regularized regression (10-fold cross-validation).); gam: family (binomial (link = ""logit"")), formula (occurrence ~ s(predictor1) + s(predictor2)...), weights (true presence records: weight = 1, pseudo-absence records: weight = presenceNum / backgroundNum), method (""REML""), notes (R package mgcv); mars: formula (occurrence ~ .), degree (2 ), thresh (0.00001), notes (R package caret, earth and doParallel. We tuned the model with 5-fold cross-validation.), nprune (1 + number_of_predictors), trainControl (method = ""cv"", number = 5, classProbs = TRUE, summaryFunction = twoClassSummary); randomForest: ntree (500 (1000 for downsampled RF)), notes (R package randomForest. For RF downsampled, we set sampsize = c(""0"" = presenceNumber, ""1"" = backgroundNumber) and replace = TRUE.), formula (occurrence ~ .); brt: nTrees (automatically tuned (see R script)), bagFraction (0.75), notes (R package caret and dismo. Settings can be found in the R script. We performed 5-fold cross-validation.), family (""bernoulli""), tree.complexity (automatically tunes (see R script)), max.trees (10000), n.folds (5), site.weights (true presence records: weight = 1, pseudo-absence records: weight = presenceNum / backgroundNum); ann: notes (ANN was only modelled within the BIOMOD model.); fda: notes (FDA was only modelled within the BIOMOD model.); lasso: notes (see GLM); ridge: notes (see GLM); biomod: models (GLM, GBM, GAM, CTA, ANN, FDA, MARS, RF, MAXENT.Phillips), model.options (GAM = list (k = -1)), NbRunEval (3), DataSplit (80), models.eval.meth (""ROC""), rescal.all.models (FALSE), do.full.models (FALSE), em.by (""all""), eval.metric (""ROC""), eval.metric.quality.threshold (NULL), prob.mean (TRUE), prob.cv (FALSE), prob.ci (FALSE), prob.median (FALSE), committee.averaging (FALSE), prob.mean.weight (TRUE), prob.mean.weight.decay (""proportional""), VarImport (3); ensemble: models (GAM, Lasso, BRT, RF, and MaxEnt (all with same background data)), combinationMethod (average of predictions)"
"Model","Model settings","Model settings (extrapolation)",""
"Model","Model estimates","Coefficients","mean posterior"
"Model","Model estimates","Parameter uncertainty",""
"Model","Model estimates","Variable importance","caret::varImp for GLM, GAM, MARS, and XGBoost; coefficients of Lasso and Ridge regression;  permutation importance for MaxEnt; beta coefficients for MaxNet; for BRT; Mean decrease in Gini index for RF and RF downsampled; XXX for Biomod; averaged importance for simple Ensemble model."
"Model","Model selection - model averaging - ensembles","Model selection","We selected the five most independent individual model predictors (i.e., GAM, lasso, maxent, BRT and RF) following Valavi et al. 2021 and averaged their predicted probability of presence. In addition, we used the R package biomod2 to create another ensemble model of GLM, GBM, GAM, CTA, ANN, FDA, MARS, RF and MAXENT.Phillips."
"Model","Model selection - model averaging - ensembles","Model averaging",""
"Model","Model selection - model averaging - ensembles","Model ensembles","see R script"
"Model","Analysis and Correction of non-independence","Spatial autocorrelation",""
"Model","Analysis and Correction of non-independence","Temporal autocorrelation",""
"Model","Analysis and Correction of non-independence","Nested data",""
"Model","Threshold selection","Threshold selection",""
"Assessment","Performance statistics","Performance on training data","AUC"
"Assessment","Performance statistics","Performance on validation data","AUC"
"Assessment","Performance statistics","Performance on test data","AUC; Kappa; TSS"
"Assessment","Plausibility check","Response shapes",""
"Assessment","Plausibility check","Expert judgement",""
"Prediction","Prediction output","Prediction unit","Continuous predictions of occurrence probability per species and predicted presence per species that were obtained by binarizing the predicted occurrence probabilities using the threshold selection method based on maximizing the sum of sensitivity and specificity."
"Prediction","Prediction output","Post-processing","In the Supplementary to this paper, output maps of occurrence probability and overall species richness are clipped to the German political boundary."
"Prediction","Uncertainty quantification","Algorithmic uncertainty",""
"Prediction","Uncertainty quantification","Input data uncertainty",""
"Prediction","Uncertainty quantification","Parameter uncertainty",""
"Prediction","Uncertainty quantification","Scenario uncertainty",""
"Prediction","Uncertainty quantification","Novel environments",""
